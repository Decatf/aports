# Contributor: Robert Yang <decatf@gmail.com>
# Maintainer: Robert Yang <decatf@gmail.com>
pkgname=youtube-viewer
pkgver=3.5.0
pkgrel=0
pkgdesc="Lightweight application for searching and streaming videos from YouTube."
url="https://github.com/trizen/youtube-viewer/"
arch="all"
license="Artistic-2.0"
depends="perl perl-data-dump perl-json perl-lwp-protocol-https perl-libwww"
makedepends="perl-module-build perl-lwp-protocol-https"
subpackages="$pkgname-doc $pkgname-gtk"
source="$pkgname-$pkgver.tar.gz::https://github.com/trizen/$pkgname/archive/$pkgver.tar.gz"

build() {
	cd "$builddir"
	perl Build.PL --installdirs vendor --gtk
}

check() {
	cd "$builddir"
	./Build test
}

package() {
	cd "$builddir"
	./Build install --destdir "$pkgdir"
	rm -r "$pkgdir"/usr/lib
}

gtk() {
	depends="$depends youtube-viewer perl-glib perl-gtk2 perl-pango perl-file-sharedir"

	mkdir -p "$subpkgdir"/usr/bin/
	mv "$pkgdir"/usr/bin/gtk-youtube-viewer \
		"$subpkgdir"/usr/bin/gtk-youtube-viewer

	mkdir -p "$subpkgdir"/usr/share/applications
	mv "$pkgdir"/usr/share/perl5/vendor_perl/auto/share/dist/WWW-YoutubeViewer/gtk-youtube-viewer.desktop \
		"$subpkgdir"/usr/share/applications/gtk-youtube-viewer.desktop

	mkdir -p "$subpkgdir"/usr/share/perl5/vendor_perl/auto/share/dist
	mv "$pkgdir"/usr/share/perl5/vendor_perl/auto/share/dist/WWW-YoutubeViewer \
		"$subpkgdir"/usr/share/perl5/vendor_perl/auto/share/dist/WWW-YoutubeViewer
}

sha512sums="1b6fe4555639f894d861b0f83c489a3e76660e0ef8e7c8661dee89d5530bbf31ef669ba3799b669b575b70547ed9e4ad10895312d576ba979fa9bfffdbd00425  youtube-viewer-3.5.0.tar.gz"
